<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>哎哟大学管理后台</title>

    <!-- Bootstrap Core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="../vendor/morrisjs/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- 本页面的样式 -->
    <link rel="stylesheet" href="../dist/css/prattle.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">哎哟大学管理后台</a>
            </div>
            <!-- /.navbar-header -->

            <ul class="nav navbar-top-links navbar-right">

                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user fa-fw"></i> <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <!-- <li><a href="#"><i class="fa fa-user fa-fw"></i> User Profile</a>
                        </li>
                        <li><a href="#"><i class="fa fa-gear fa-fw"></i> Settings</a>
                        </li> -->
                        <!-- <li class="divider"></li> -->
                        <li><a href="login.html"><i class="fa fa-sign-out fa-fw"></i> 注销</a>
                        </li>
                    </ul>
                    <!-- /.dropdown-user -->
                </li>
                <!-- /.dropdown -->
            </ul>
            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        <!-- <li class="sidebar-search">
                            <div class="input-group custom-search-form">
                                <input type="text" class="form-control" placeholder="Search...">
                                <span class="input-group-btn">
                                <button class="btn btn-default" type="button">
                                    <i class="fa fa-search"></i>
                                </button>
                            </span>
                            </div>
                        </li> -->
                        <li>
                            <a href="index.html"><i class="fa fa-dashboard fa-fw"></i> 所有菜单</a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-bar-chart-o fa-fw"></i> 统计 <span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="flot.html">树洞</a>
                                </li>
                                <li>
                                    <a href="flot.html">二手交易</a>
                                </li>
                                <li>
                                    <a href="flot.html">校园商圈</a>
                                </li>
                                <li>
                                    <a href="flot.html">趣玩</a>
                                </li>
                                <li>
                                    <a href="flot.html">去约</a>
                                </li>
                                <li>
                                    <a href="flot.html">校园情话</a>
                                </li>

                                <!-- <li>
                                    <a href="morris.html">Morris.js Charts</a>
                                </li> -->
                            </ul>
                            <!-- /.nav-second-level -->
                        </li>
                        <!-- <li>
                            <a href="tables.html"><i class="fa fa-table fa-fw"></i> 审核</a>
                        </li> -->
                        <li>
                            <a href="schoolPrattle.html"><i class="fa fa-edit fa-fw"></i> 校园情话</a>
                            <a href="fun.html"><i class="fa fa-edit fa-fw"></i> 趣玩</a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-wrench fa-fw"></i> 审核<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="trade.html">校园商圈</a>
                                </li>
                                <li>
                                    <a href="play.html">去约</a>
                                </li>

                            </ul>
                            <!-- /.nav-second-level -->
                        </li>
                        <!-- <li>
                            <a href="#"><i class="fa fa-sitemap fa-fw"></i> Multi-Level Dropdown<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="#">Second Level Item</a>
                                </li>
                                <li>
                                    <a href="#">Second Level Item</a>
                                </li>
                                <li>
                                    <a href="#">Third Level <span class="fa arrow"></span></a>
                                    <ul class="nav nav-third-level">
                                        <li>
                                            <a href="#">Third Level Item</a>
                                        </li>
                                        <li>
                                            <a href="#">Third Level Item</a>
                                        </li>
                                        <li>
                                            <a href="#">Third Level Item</a>
                                        </li>
                                        <li>
                                            <a href="#">Third Level Item</a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li> -->
                        <!-- <li>
                            <a href="#"><i class="fa fa-files-o fa-fw"></i> Sample Pages<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="blank.html">Blank Page</a>
                                </li>
                                <li>
                                    <a href="login.html">Login Page</a>
                                </li>
                            </ul>
                        </li> -->
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
          <h3>编辑文章</h3>
          <p class="bg-danger">这里只是添加文章信息, 编辑文章去<a href="http://markdown.xiaoshujiang.com/">编辑器</a>. 编辑之后，转成html格式下载，然后来
            这里上传。
          </p>

          <hr>

          <div class="row">
              <div class="col-lg-12">
                  <h1 class="page-header">已有文章信息</h1>
              </div>
              <!-- /.col-lg-12 -->
          </div>
          <!-- /.row -->
          <div class="row">
              <div class="col-lg-12">
                  <div class="panel panel-default">
                      <div class="panel-heading">
                          表格
                      </div>
                      <!-- /.panel-heading -->
                      <div class="panel-body">
                          <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-prattle">
                              <thead>
                                  <tr>
                                      <th>题目</th>
                                      <th>作者</th>
                                      <th>日期</th>
                                      <th>浏览次数</th>
                                      <th>操作</th>
                                  </tr>
                              </thead>


                          </table>
                          <!-- /.table-responsive -->
                          <!-- <div class="well">
                              <h4>DataTables Usage Information</h4>
                              <p>DataTables is a very flexible, advanced tables plugin for jQuery. In SB Admin, we are using a specialized version of DataTables built for Bootstrap 3. We have also customized the table headings to use Font Awesome icons in place of images. For complete documentation on DataTables, visit their website at <a target="_blank" href="https://datatables.net/">https://datatables.net/</a>.</p>
                              <a class="btn btn-default btn-lg btn-block" target="_blank" href="https://datatables.net/">View DataTables Documentation</a>
                          </div> -->
                      </div>
                      <!-- /.panel-body -->
                  </div>
                  <!-- /.panel -->
              </div>
              <!-- /.col-lg-12 -->
          </div>
          <!-- /.row -->

        <br>

        <button type='button' class='btn btn-primary' id="newPrattle">新增文章</button>

        <form class="form-horizontal prattle-info-form" role="form"  enctype="multipart/form-data" >
          <div class="form-group">
            <label for="prattle-title" class="col-sm-2 control-label">文章题目</label>
            <div class="col-sm-10">
              <input type="text" class="prattle-title" placeholder="填写文章的题目">
            </div>
          </div>
          <div class="form-group">
            <label for="prattle-author" class="col-sm-2 control-label">作者</label>
            <div class="col-sm-10">
              <input type="text"  class="prattle-author" placeholder="填写作者姓名">
            </div>
          </div>
          <div class="form-group">
            <label for="prattle-path" class="col-sm-2 control-label">封面图路径</label>
            <div class="col-sm-10">
              <input type="text"  class="prattle-path" placeholder="填写你在七牛上传图片的路径">
            </div>
          </div>

          <div class="form-group">
             <label for="prattleInputFile">上传文章(html格式)</label>
             <input type="file" id="prattleInputFile">
           </div>

          <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
              <button type="submit" class="btn btn-default" id="prattle-submit">提交</button>
            </div>
          </div>
        </form>
        </div>
        <!-- /.page wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>

    <!-- DataTables JavaScript -->
    <script src="../vendor/datatables/js/jquery.dataTables.min.js"></script>
    <script src="../vendor/datatables-plugins/dataTables.bootstrap.min.js"></script>
    <script src="../vendor/datatables-responsive/dataTables.responsive.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>

    <script src="../dist/js/schoolPrattle.js"></script>
    <script type="text/javascript">
    //  展示已经发布过的文章
    $(document).ready(function() {
      var url = "http://" + location.host + "/admin/schoolPrattle";
      $('#dataTables-prattle').DataTable({
          "processing": true,
          "serverSide": true,
          "ajax": {
            url: url,
            type: "GET",
            dataType: "json",
            dataSrc: "prattles",
      			contentType: "application/json"
          },
          "columns": [
            {"data": "title"},
            {"data": "author"},
            {"data": "date"},
            {"data": "view"},
            {
              "data": "_id",
              "render": function(data, type, row) {
                return "<button class='btn btn-primary delete' data-pId=" + data+ ">删除</button>"
              }
            }
          ]
      });

      //  删除操作
      $('button.delete').on('click', function(e) {
        var r = confirm("确定要删除吗?操作不可撤销。。");
        if (r==true) {
          var pId = $(this).attr('data-pId');
          var info = {
            pId: pId,
            type: "del"
          }
          var url = "http://" + location.host + "/admin/schoolPrattle/action";
          $.ajax({
            type: "POST",
            url: url,
            dataType: "json",
          	contentType: "application/json",
            data: JSON.stringify(info),
            processData: false,
            success: function (data) {
              if (data.success) {
                $(that).parent().parent();remove();
                alert("删除成功！");
              }
            },
            error: function (data) {
                console.log("删除失败");
            }

          });

        }

      })

    });

    </script>
</body>

</html>
